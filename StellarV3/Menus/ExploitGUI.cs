using MelonLoader;
using StellarV3.Features.Pickups;
using StellarV3.Features.Exploits;
using StellarV3.SDK.Patching;
using StellarV3.SDK.Utils;
using UnityEngine;
using static StellarV3.GUIButtonAPI.GUIButtonAPI;

namespace StellarV3.Menus
{
    internal class ExploitGUI
    {
        private static int yOffset = 0;
        public static bool cLag = false;
        public static bool cSpam = false;
        public static void Menu()
        {
            yOffset = 80;

            new GUIToggleButton("Block Udon", () =>
            {
                Patch.antiUdon = true;
                PopupUtils.HudMessage("Block Udon", "Toggled On", 3);
            },
            () =>
            {
                Patch.antiUdon = false;
                PopupUtils.HudMessage("Block Udon", "Toggled Off", 3);
            }, () => Patch.antiUdon, yOffset);

            yOffset += 35;

            new GUIToggleButton("Chatbox Lagger", () =>
            {
                cLag = true;
                ChatBoxLagger.State(true);
                PopupUtils.HudMessage("Chatbox Lagger", "Toggled On", 3);
            },
            () =>
            {
                cLag = false;
                ChatBoxLagger.State(false);
                PopupUtils.HudMessage("Chatbox Lagger", "Toggled Off", 3);
            }, () => cLag, yOffset);

            yOffset += 35;

            new GUIToggleButton("Chatbox Spammer", () =>
            {
                cSpam = true;
                ChatBoxSpammer.State(true);
                PopupUtils.HudMessage("Chatbox Spammer", "Toggled On", 3);
            },
            () =>
            {
                cSpam = false;
                ChatBoxSpammer.State(false);
                PopupUtils.HudMessage("Chatbox Spammer", "Toggled Off", 3);
            }, () => cSpam, yOffset);

            yOffset += 35;

            new GUIToggleButton("Fake Lag", () =>
            {
                FakeLag.fakeLag = true;
                MelonCoroutines.Start(FakeLag.FakeLagToggle());
                PopupUtils.HudMessage("Fake Lag", "Toggled On", 3);
            },
            () =>
            {
                FakeLag.fakeLag = false;
                PopupUtils.HudMessage("Fake Lag", "Toggled Off", 3);
            }, () => FakeLag.fakeLag, yOffset);

            yOffset += 35;

            new GUIToggleButton("Pickup Reach", () =>
            {
                PickupMods.infReach = true;
                PickupMods.InfReach(true);
                PopupUtils.HudMessage("Pickup Reach", "Toggled On", 3);
            },
            () =>
            {
                PickupMods.infReach = false;
                PickupMods.InfReach(false);
                PopupUtils.HudMessage("Pickup Reach", "Toggled Off", 3);
            }, () => PickupMods.infReach, yOffset);

            yOffset += 35;

            new GUIToggleButton("Owner Spoof", () =>
            {
                Patch.ownerSpoof = true;
                PopupUtils.HudMessage("Owner Spoof", "Toggled On", 3);
            },
            () =>
            {
                Patch.ownerSpoof = false;
                PopupUtils.HudMessage("Owner Spoof", "Toggled Off", 3);
            }, () => Patch.ownerSpoof, yOffset);

            yOffset += 35;

            new GUIToggleButton("Custom Spoof", () =>
            {
                Patch.customSpoof = true;
                PopupUtils.HudMessage("Custom Spoof", "Toggled On", 3);
            },
            () =>
            {
                Patch.customSpoof = false;
                PopupUtils.HudMessage("Custom Spoof", "Toggled Off", 3);
            }, () => Patch.customSpoof, yOffset);

            yOffset += 35;

            new GUISingleButton("Set Custom Name", () =>
            {
                Patch.customName = GUIUtility.systemCopyBuffer;
                if (!string.IsNullOrEmpty(Patch.customName))
                {
                    PopupUtils.HudMessage("Name Spoof", $"Name Set To {Patch.customName}", 3);
                }
                else
                {
                    PopupUtils.HudMessage("Name Spoof", "Invalid Name Given", 3);
                }
            }, yOffset);

            yOffset += 35;

            new GUISingleButton("Change Avatar By ID", () => 
            {
                string avatarID = GUIUtility.systemCopyBuffer;
                if (!string.IsNullOrEmpty(avatarID) && avatarID.Contains("avtr_"))
                {
                    PlayerUtils.CloneAvatar(avatarID);
                    PopupUtils.HudMessage("Avatar", $"Changed to {avatarID}", 3);
                }
                else
                {
                    PopupUtils.HudMessage("Avatar", "Invalid Avatar ID!", 3);
                }
            }, yOffset);

            yOffset += 35;

            new GUISingleButton("Set Custom Portal Spam", () =>
            {
                string worldSecureCode = GUIUtility.systemCopyBuffer;
                if (!string.IsNullOrEmpty(worldSecureCode) && !worldSecureCode.Contains("wrld_"))
                {
                    PortalExploits.wsc = worldSecureCode;
                    PopupUtils.HudMessage("Custom Portal", $"Changed to {worldSecureCode}", 3);
                }
                else
                {
                    PopupUtils.HudMessage("Custom Portal", "Invalid World Secure Code! WSC Should Look Like This y36bckdg", 3);
                }
            }, yOffset);

            yOffset += 35;
        }
    }
}
